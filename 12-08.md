# «Резервное копирование баз данных» - Жакунец Максим


---

### Задание 1. Резервное копирование

### Кейс
Финансовая компания решила увеличить надёжность работы баз данных и их резервного копирования. 

Необходимо описать, какие варианты резервного копирования подходят в случаях: 

1.1. Необходимо восстанавливать данные в полном объёме за предыдущий день.

1.2. Необходимо восстанавливать данные за час до предполагаемой поломки.

1.3.* Возможен ли кейс, когда при поломке базы происходило моментальное переключение на работающую или починенную базу данных.

*Приведите ответ в свободной форме.*


### Решение

1.1 Full backup(Полное копирование), при условии, что он делался в конце предыдущего рабочего дня. Incremental backup(Инкрементное копирование), differential backup (дифирианциальное копирование), при условии что есть Full backup и соблюдены условия для Incremental и differential backup`ов  (differential делались в конце предыдущего рабочено дня). Холодное резервирование БД при условии что оно делалось в конце предыдущего рабочено дня.

1.2 Инкрементное резервное копирование подойдет. Инкрементное резервное копирование использует полную копию, как начальную точку. Затем выполняется резервное копирование только блоков данных, которые были изменены с момента последнего резервного задания, с заданным периодом выполнения задания. В зависимости от политики хранения резервных копии, через определенный период создается новая полная копия для повторения цикла. Частота инкрементного копирование зависит от нескольких важных факторов: Частота изменений в базе данных, чем чаще происходят изменения тем чаще нужно копирование, так же надо учесть время, требуемое для восстановления данных на основе резервной копии. Если время восстановления длительное, возможно, вам понадобятся более частые инкрементные резервные копии, чтобы минимизировать потерю данных.
Обычно рекомендуется настроить инкрементное резервное копирование на достаточно частой основе, чтобы минимизировать потерю данных в случае сбоя. Например, каждый час или каждые несколько часов может быть приемлемой частотой для многих систем. Но конкретная частота должна быть определена на основе требований и ограничений.

---

### Задание 2. PostgreSQL

2.1. С помощью официальной документации приведите пример команды резервирования данных и восстановления БД (pgdump/pgrestore).

2.1.* Возможно ли автоматизировать этот процесс? Если да, то как?

*Приведите ответ в свободной форме.*

### Решение

2.1 

```
pg_dump [параметр-подключения...] [параметр...] [имя_бд]

$ pg_dump mydb > db.sql

pg_restore [параметр-подключения...] [параметр...] [имя_файла]

$ pg_restore -d newdb db.dump

```

---

### Задание 3. MySQL

3.1. С помощью официальной документации приведите пример команды инкрементного резервного копирования базы данных MySQL. 

3.1.* В каких случаях использование реплики будет давать преимущество по сравнению с обычным резервным копированием?

*Приведите ответ в свободной форме.*

### Решение

3.1 --incremental-base=dir:directory_path
 Или через XtraBackup
xtrabackup --backup --target-dir=/root/backupdb/inc1 --incremental-basedir=/root/backupdb/full

---

Задания, помеченные звёздочкой, — дополнительные, то есть не обязательные к выполнению, и никак не повлияют на получение вами зачёта по этому домашнему заданию. Вы можете их выполнить, если хотите глубже шире разобраться в материале.
